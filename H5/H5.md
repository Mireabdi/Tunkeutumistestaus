### Tunkeutumistestaus ICI005AS3A-3005

## Abdirahman Mire

# H5 

### Työympäristö:

Käyttöjärjestelmä: Windows 11 Pro 64-bit

CPU: Intel Core i7-12700KF - 4 cores in use

RAM: 6 GB DDR4

Disk: 80gb

Virtuaalikone: VMware, Kali Linux

## X) Karvinen 2022: Cracking Passwords with Hashcat

- Hashcatilla ja sanakirjalla voi testata hashien purkamista turvallisesti omilla harjoitushasheilla.

- Hashin tyyppi tunnistettiin hashid-ohjelmalla, ja oikea tyyppi valittiin ehdotusten perusteella (esim. MD5).

- Hashcat-komennolla hash purettiin ja ratkaisu tallennettiin tiedostoon.

## A) Hashcat 

Aloitin komennoilla: 

`sudo apt-get update`

`sudo apt-get -y install hashid hashcat wget`

![kuva1](/H5/kuvat/kuva1.png)

Loin hakemiston: 

`mkdir hashed`

`cd hashed`

Latasin sanakirjat: 

 `wget https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz`
 
 `tar xf rockyou.txt.tar.gz`

 `tar xf rockyou.txt.tar.gz`

![kuva1](/H5/kuvat/kuva2.png)

 Käytin esimerkkinä hashiä `6b1628b016dff46e6fa35684be6acc96`
 
 Seuraavaksi selvitin hash tyypin komennolla: 
 
 `hashid -m 6b1628b016dff46e6fa35684be6acc96`

![kuva1](/H5/kuvat/kuva3.png)

Hashid-ohjelma näytti -m-parametrin avulla numeron, jota käytettiin hashcatissa.

Yleensä oikea hash tyyppi on kolmen ensimmäisen joukossa, valitsin MD5 sen yleisyyden vuoksi.


Seuraavaksi aloin purkaamaan tiivistettä komennolla: 

`hashcat -m 0 '6b1628b016dff46e6fa35684be6acc96' rockyou.txt -o Cracked1`

Hashcat-komennolla purettiin hash 6b1628b016dff46e6fa35684be6acc96 käyttäen -m 0-asetusta, joka vastasi hash-tyyppiä. Ratkaisu tallennettiin tekstitiedostoon Cracked1.

![kuva1](/H5/kuvat/kuva4.png)

Komennon tulostus: 

![kuva1](/H5/kuvat/kuva5.png)

Salasana tallentui kohteeseen Cracked1 kasnioon:

![kuva1](/H5/kuvat/kuva6.png)

## B) John the Ripper

Aloitin lataamalla tarvittavat paketit komennoilla: 

`sudo apt-get update`

`sudo apt-get -y install micro bash-completion git build-essential libssl-dev zlib1g zlib1g-dev libbz2-1.0 libbz2-dev atool zip wget`

`git clone --depth=1 https://github.com/openwall/john.git`

![kuva1](/H5/kuvat/kuva7.png)

`cd john/src/`

`./configure`

Kokeilin ensin vain `./configure` muuta antoi virhe ilmoituksen että ei ole OpenSSL asennettuna kokeilin lataa OpenSSL mutta ei silti toiminut. Virhe ilmoituksessa annettin vaihtoehto käyttää parametria --without-openssl ja tällä sain seuraavan tulostuksen:

![kuva1](/H5/kuvat/kuva8.png)

Seuraavaksi :

`make -s clean && make -sj4`

`cd ..//run/`

`./jhon`

![kuva1](/H5/kuvat/kuva9.png)

Latasin harjoitus-zip ja loin hashin :

`wget https://TeroKarvinen.com/2023/crack-file-password-with-john/tero.zip`

`./zip2john tero.zip > tero.zip.hash`

Aloin murtamaan salasanaa sanalistalla: 

`./john tero.zip.hash`

`./john --show tero.zip.hash`

![kuva1](/H5/kuvat/kuva10.png)

Sain selville salasanan, näyttäisi olevan butterfly.

Kokeilin salasanaa: 

`unzip tero.zip`

`cat secretFiles/SECRET.md`

![kuva1](/H5/kuvat/kuva11.png)

## E) Murra Tiedosto: oma PDF

Loin ensin test.txt :
`echo "Tämä on harjoitustiedosto" > test.txt`

Muutin pdf:ksi :

`enscript -B -o - test.txt | ps2pdf - test.pdf`

kuva12
kuva13

Salasin pdf tiedoston:

`qpdf --encrypt salainen salainen 256 -- test.pdf salattu.pdf`

kuva 14

Testasin että pdf kysyy salasanaa: 

`xdg-open salattu.pdf`

kuva15

Tein oman sanalistan 

`nano ~/mywordlist.txt`

 kuva16

Itse murto john the ripperillä:

`./john --wordlist=$HOME/mywordlist.txt saalattu.hash`

 kuva17
 kuva18

## F) Tiivisteen murto: linux käyttäjän salasana

Loin uude testikäyttäjä: 

`sudo useradd -m testuser`

`sudo passwd testuser`

kuva19

laitoin salasanaksi testi joka löytyy wordlististä jonka loin aikasemmassa tehtävässä.

kuva 21

seuraavaksi komennolla

`sudo grep testuser /etc/shadow > ~/testuser.hash`

Tallensin käyttäjän testuser salasanatiivisteen /etc/shadow-tiedostosta tiedostoon ¬/testuser.hash murtoa varten

kuva20

ja salasanan murto John the ripperillä:


`./john --wordlist=$HOME/mywordlist.txt testuser.hash`

kuva22
kuva23


### Referenssit:

Karvinen2025: https://terokarvinen.com/tunkeutumistestaus/#h4-leviamassa

Karvinen2025: https://terokarvinen.com/2022/cracking-passwords-with-hashcat/
 
 
